<% content_for :title, "Edit User - #{@user.full_name}" %>

<div class="space-y-6">
  <!-- Header -->
  <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
    <div>
      <h1 class="text-3xl font-bold text-primary">Edit User</h1>
      <p class="text-base-content/70 mt-1">Update user information</p>
    </div>
    <div class="flex gap-2">
      <%= link_to system_admin_user_path(@user), 
          class: "btn btn-ghost gap-2" do %>
        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
        </svg>
        Back to User
      <% end %>
      
      <%= link_to system_admin_users_path, 
          class: "btn btn-ghost gap-2" do %>
        All Users
      <% end %>
    </div>
  </div>

  <!-- Form -->
  <div class="card bg-base-100 shadow-xl max-w-2xl mx-auto">
    <div class="card-body">
      <%= form_with model: [:system_admin, @user], method: :patch, local: true, class: "space-y-6" do |form| %>
        
        <!-- Basic Information -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="form-control">
            <label class="label">
              <span class="label-text text-base font-semibold">First Name</span>
              <span class="label-text-alt text-error">*Required</span>
            </label>
            <%= form.text_field :first_name, 
                class: "input input-bordered w-full #{'input-error' if @user.errors[:first_name].any?}", 
                required: true %>
            <% if @user.errors[:first_name].any? %>
              <label class="label">
                <span class="label-text-alt text-error"><%= @user.errors[:first_name].first %></span>
              </label>
            <% end %>
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text text-base font-semibold">Last Name</span>
              <span class="label-text-alt text-error">*Required</span>
            </label>
            <%= form.text_field :last_name, 
                class: "input input-bordered w-full #{'input-error' if @user.errors[:last_name].any?}", 
                required: true %>
            <% if @user.errors[:last_name].any? %>
              <label class="label">
                <span class="label-text-alt text-error"><%= @user.errors[:last_name].first %></span>
              </label>
            <% end %>
          </div>
        </div>

        <div class="form-control">
          <label class="label">
            <span class="label-text text-base font-semibold">Email</span>
            <span class="label-text-alt text-error">*Required</span>
          </label>
          <%= form.email_field :email, 
              class: "input input-bordered w-full #{'input-error' if @user.errors[:email].any?}", 
              required: true %>
          <% if @user.errors[:email].any? %>
            <label class="label">
              <span class="label-text-alt text-error"><%= @user.errors[:email].first %></span>
            </label>
          <% end %>
        </div>

        <!-- Password -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
          <div class="form-control">
            <label class="label">
              <span class="label-text text-base font-semibold">New Password</span>
              <span class="label-text-alt">Leave blank to keep current</span>
            </label>
            <%= form.password_field :password, 
                class: "input input-bordered w-full #{'input-error' if @user.errors[:password].any?}" %>
            <% if @user.errors[:password].any? %>
              <label class="label">
                <span class="label-text-alt text-error"><%= @user.errors[:password].first %></span>
              </label>
            <% end %>
          </div>

          <div class="form-control">
            <label class="label">
              <span class="label-text text-base font-semibold">Confirm New Password</span>
            </label>
            <%= form.password_field :password_confirmation, 
                class: "input input-bordered w-full #{'input-error' if @user.errors[:password_confirmation].any?}" %>
            <% if @user.errors[:password_confirmation].any? %>
              <label class="label">
                <span class="label-text-alt text-error"><%= @user.errors[:password_confirmation].first %></span>
              </label>
            <% end %>
          </div>
        </div>

        <!-- Role -->
        <div class="form-control">
          <label class="label">
            <span class="label-text text-base font-semibold">Role</span>
          </label>
          <%= form.select :role, 
              options_for_select([
                ['Member', 'member'],
                ['System Administrator', 'system_admin']
              ], @user.role), 
              {}, 
              { class: "select select-bordered w-full" } %>
          <label class="label">
            <span class="label-text-alt">System Administrators have full access to all features</span>
          </label>
        </div>

        <!-- Actions -->
        <div class="flex flex-col sm:flex-row gap-4 pt-6 border-t border-base-300">
          <%= form.submit "Update User", 
              class: "btn btn-primary gap-2 flex-1 sm:flex-none" %>
          
          <%= link_to system_admin_user_path(@user), 
              class: "btn btn-ghost gap-2 flex-1 sm:flex-none" do %>
            Cancel
          <% end %>
        </div>

      <% end %>
    </div>
  </div>
</div>